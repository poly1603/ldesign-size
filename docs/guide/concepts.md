# æ ¸å¿ƒæ¦‚å¿µ

ç†è§£ **@ldesign/size** çš„æ ¸å¿ƒæ¦‚å¿µå°†å¸®åŠ©ä½ æ›´å¥½åœ°ä½¿ç”¨è¿™ä¸ªåº“ã€‚æœ¬æŒ‡å—å°†æ·±å…¥ä»‹ç»ç³»ç»Ÿçš„è®¾è®¡ç†å¿µå’Œæ ¸å¿ƒç»„ä»¶ã€‚

## ğŸ¯ è®¾è®¡ç†å¿µ

### ç”¨æˆ·ä½“éªŒä¼˜å…ˆ

@ldesign/size çš„æ ¸å¿ƒç†å¿µæ˜¯**è®©æ¯ä¸ªç”¨æˆ·éƒ½èƒ½è·å¾—æœ€é€‚åˆè‡ªå·±çš„ç•Œé¢ä½“éªŒ**ï¼š

- **è§†è§‰éšœç¢ç”¨æˆ·** éœ€è¦æ›´å¤§çš„å­—ä½“å’Œæ§ä»¶
- **è€å¹´ç”¨æˆ·** åå¥½æ›´å¤§çš„ç•Œé¢å…ƒç´ 
- **ç§»åŠ¨è®¾å¤‡ç”¨æˆ·** éœ€è¦é€‚åˆè§¦æ‘¸çš„å°ºå¯¸
- **é«˜åˆ†è¾¨ç‡å±å¹•ç”¨æˆ·** éœ€è¦æ›´ç²¾ç»†çš„æ˜¾ç¤º

### å¼€å‘è€…å‹å¥½

- **é›¶é…ç½®å¯åŠ¨** - å¼€ç®±å³ç”¨çš„é»˜è®¤é…ç½®
- **æ¸è¿›å¢å¼º** - å¯ä»¥é€æ­¥æ·»åŠ é«˜çº§åŠŸèƒ½
- **ç±»å‹å®‰å…¨** - å®Œæ•´çš„ TypeScript æ”¯æŒ
- **æ¡†æ¶æ— å…³** - æ ¸å¿ƒåŠŸèƒ½ä¸ä¾èµ–ä»»ä½•æ¡†æ¶

### æ€§èƒ½ä¼˜å…ˆ

- **è½»é‡çº§** - æ ¸å¿ƒåº“ä½“ç§¯å°ï¼Œè¿è¡Œæ—¶å¼€é”€ä½
- **æ™ºèƒ½ç¼“å­˜** - é¿å…é‡å¤è®¡ç®—å’ŒDOMæ“ä½œ
- **æŒ‰éœ€åŠ è½½** - æ”¯æŒæŒ‰éœ€åŠ è½½åŠŸèƒ½æ¨¡å—

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### åˆ†å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                åº”ç”¨å±‚                    â”‚
â”‚  Vue Components, Composables, Plugins  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                APIå±‚                    â”‚
â”‚     ä¾¿æ·API, å¿«æ·å‡½æ•°, å·¥å…·æ–¹æ³•          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                æ ¸å¿ƒå±‚                    â”‚
â”‚  SizeManager, CSSç”Ÿæˆå™¨, äº‹ä»¶ç³»ç»Ÿ       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                åŸºç¡€å±‚                    â”‚
â”‚    ç±»å‹å®šä¹‰, å·¥å…·å‡½æ•°, å¸¸é‡é…ç½®          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. SizeManager (å°ºå¯¸ç®¡ç†å™¨)

è´Ÿè´£ç®¡ç†å°ºå¯¸çŠ¶æ€å’Œé…ç½®ï¼š

```typescript
interface SizeManager {
  // çŠ¶æ€ç®¡ç†
  getCurrentMode: () => SizeMode
  setMode: (mode: SizeMode) => void
  getConfig: (mode?: SizeMode) => SizeConfig

  // CSS ç®¡ç†
  generateCSSVariables: () => Record<string, string>
  injectCSS: () => void
  removeCSS: () => void

  // äº‹ä»¶ç®¡ç†
  onSizeChange: (callback: SizeChangeCallback) => () => void

  // ç”Ÿå‘½å‘¨æœŸ
  destroy: () => void
}
```

#### 2. CSS Generator (CSSç”Ÿæˆå™¨)

è´Ÿè´£ç”ŸæˆCSSå˜é‡ï¼š

```typescript
interface CSSGenerator {
  generate: (config: SizeConfig, prefix: string) => Record<string, string>
  generatePreset: (mode: SizeMode) => Record<string, string>
  mergeVariables: (...variables: Record<string, string>[]) => Record<string, string>
}
```

#### 3. CSS Injector (CSSæ³¨å…¥å™¨)

è´Ÿè´£å°†CSSå˜é‡æ³¨å…¥åˆ°é¡µé¢ï¼š

```typescript
interface CSSInjector {
  inject: (variables: Record<string, string>, selector: string) => void
  remove: (selector: string) => void
  isInjected: (selector: string) => boolean
  update: (variables: Record<string, string>, selector: string) => void
}
```

#### 4. Storage Manager (å­˜å‚¨ç®¡ç†å™¨)

è´Ÿè´£æŒä¹…åŒ–å­˜å‚¨ï¼š

```typescript
interface StorageManager {
  get: <T>(key: string, defaultValue?: T) => T | null
  set: <T>(key: string, value: T) => void
  remove: (key: string) => void
  clear: () => void
  has: (key: string) => boolean
}
```

## ğŸ¨ å°ºå¯¸æ¨¡å¼ç³»ç»Ÿ

### é¢„è®¾æ¨¡å¼

| æ¨¡å¼ | å­—ä½“å¤§å° | é—´è· | è¾¹æ¡†åœ†è§’ | é€‚ç”¨åœºæ™¯ |
|------|----------|------|----------|----------|
| `small` | 12px | 6px | 3px | ç§»åŠ¨è®¾å¤‡ã€ç´§å‡‘å¸ƒå±€ |
| `medium` | 14px | 8px | 4px | æ¡Œé¢è®¾å¤‡ã€æ ‡å‡†å¸ƒå±€ |
| `large` | 16px | 12px | 6px | å¤§å±è®¾å¤‡ã€æ— éšœç¢è®¿é—® |

### é…ç½®ç»“æ„

```typescript
interface SizeConfig {
  // åŸºç¡€å­—ä½“
  fontSize: string
  fontSizeSmall: string
  fontSizeLarge: string
  lineHeight: string

  // é—´è·ç³»ç»Ÿ
  spacing: string
  spacingSmall: string
  spacingLarge: string

  // è¾¹æ¡†ç³»ç»Ÿ
  borderRadius: string
  borderWidth: string

  // ç»„ä»¶å°ºå¯¸
  buttonHeight: string
  buttonPadding: string
  inputHeight: string
  inputPadding: string

  // è§†è§‰æ•ˆæœ
  boxShadow: string
  transitionDuration: string
  transitionEasing: string
}
```

### æ‰©å±•æ€§è®¾è®¡

```typescript
// è‡ªå®šä¹‰æ¨¡å¼
type CustomSizeMode = 'extra-small' | 'extra-large' | 'compact' | 'comfortable'

// æ‰©å±•é…ç½®
interface ExtendedSizeConfig extends SizeConfig {
  // è‡ªå®šä¹‰å±æ€§
  iconSize: string
  avatarSize: string
  cardPadding: string
}
```

## ğŸ”„ çŠ¶æ€ç®¡ç†

### çŠ¶æ€æµè½¬

```mermaid
graph TD
    A[ç”¨æˆ·æ“ä½œ] --> B[setMode]
    B --> C[éªŒè¯æ¨¡å¼]
    C --> D[æ›´æ–°çŠ¶æ€]
    D --> E[ç”ŸæˆCSSå˜é‡]
    E --> F[æ³¨å…¥CSS]
    F --> G[è§¦å‘äº‹ä»¶]
    G --> H[æ›´æ–°UI]

    D --> I[ä¿å­˜åˆ°å­˜å‚¨]
    I --> J[æŒä¹…åŒ–]
```

### äº‹ä»¶ç³»ç»Ÿ

```typescript
interface SizeChangeEvent {
  previousMode: SizeMode
  currentMode: SizeMode
  timestamp: number
  source: 'user' | 'auto' | 'responsive'
}

// äº‹ä»¶ç›‘å¬
manager.onSizeChange((event: SizeChangeEvent) => {
  console.log(`å°ºå¯¸ä» ${event.previousMode} å˜æ›´ä¸º ${event.currentMode}`)
})
```

### å“åº”å¼æ›´æ–°

```typescript
// Vue å“åº”å¼é›†æˆ
const { currentMode } = useSize()

// è‡ªåŠ¨æ›´æ–°UI
watchEffect(() => {
  console.log('å½“å‰æ¨¡å¼:', currentMode.value)
})
```

## ğŸ¨ CSS å˜é‡ç³»ç»Ÿ

### å‘½åè§„èŒƒ

CSSå˜é‡é‡‡ç”¨ç»Ÿä¸€çš„å‘½åè§„èŒƒï¼š

```css
/* æ ¼å¼: --{prefix}-{category}-{property} */
--ls-font-size          /* åŸºç¡€å­—ä½“å¤§å° */
--ls-font-size-small    /* å°å­—ä½“å¤§å° */
--ls-font-size-large    /* å¤§å­—ä½“å¤§å° */

--ls-spacing            /* åŸºç¡€é—´è· */
--ls-spacing-small      /* å°é—´è· */
--ls-spacing-large      /* å¤§é—´è· */

--ls-button-height      /* æŒ‰é’®é«˜åº¦ */
--ls-button-padding     /* æŒ‰é’®å†…è¾¹è· */
--ls-button-font-size   /* æŒ‰é’®å­—ä½“å¤§å° */
```

### å±‚çº§ç³»ç»Ÿ

```css
/* å…¨å±€å˜é‡ */
:root {
  --ls-font-size: 14px;
  --ls-spacing: 8px;
}

/* ç»„ä»¶çº§å˜é‡ */
.my-component {
  --ls-local-padding: calc(var(--ls-spacing) * 2);
}

/* çŠ¶æ€å˜é‡ */
.my-component:hover {
  --ls-local-scale: 1.05;
}
```

### è®¡ç®—å±æ€§

```css
.my-element {
  /* åŸºäºåŸºç¡€å˜é‡è®¡ç®— */
  padding: calc(var(--ls-spacing) * 1.5);
  margin: calc(var(--ls-spacing) / 2);

  /* ç»„åˆå¤šä¸ªå˜é‡ */
  border: var(--ls-border-width) solid var(--ls-border-color);
  border-radius: var(--ls-border-radius);
}
```

## ğŸ”Œ æ’ä»¶ç³»ç»Ÿ

### æ’ä»¶æ¥å£

```typescript
interface SizePlugin {
  name: string
  version: string
  install: (manager: SizeManager, options?: any) => void
  uninstall?: (manager: SizeManager) => void
}
```

### å†…ç½®æ’ä»¶

#### Vue æ’ä»¶

```typescript
const VueSizePlugin: SizePlugin = {
  name: 'vue-size',
  version: '1.0.0',
  install(manager, options) {
    // æ³¨å†Œå…¨å±€ç»„ä»¶
    // æä¾› Composition API
    // é›†æˆå“åº”å¼ç³»ç»Ÿ
  }
}
```

#### å“åº”å¼æ’ä»¶

```typescript
const ResponsivePlugin: SizePlugin = {
  name: 'responsive',
  version: '1.0.0',
  install(manager, options) {
    // ç›‘å¬åª’ä½“æŸ¥è¯¢
    // è‡ªåŠ¨è°ƒæ•´å°ºå¯¸
    // è®¾å¤‡æ£€æµ‹
  }
}
```

### è‡ªå®šä¹‰æ’ä»¶

```typescript
const MyCustomPlugin: SizePlugin = {
  name: 'my-custom-plugin',
  version: '1.0.0',
  install(manager, options) {
    // æ‰©å±•åŠŸèƒ½
    manager.addCustomMethod = () => {
      // è‡ªå®šä¹‰é€»è¾‘
    }

    // ç›‘å¬äº‹ä»¶
    manager.onSizeChange((event) => {
      // è‡ªå®šä¹‰å¤„ç†
    })
  }
}

// ä½¿ç”¨æ’ä»¶
manager.use(MyCustomPlugin, { /* é€‰é¡¹ */ })
```

## ğŸ”„ ç”Ÿå‘½å‘¨æœŸ

### åˆå§‹åŒ–æµç¨‹

```typescript
// 1. åˆ›å»ºç®¡ç†å™¨
const manager = createSizeManager(options)

// 2. åŠ è½½å­˜å‚¨çš„åå¥½
const storedMode = storage.get('size-mode')

// 3. è®¾ç½®åˆå§‹æ¨¡å¼
manager.setMode(storedMode || options.defaultMode)

// 4. ç”Ÿæˆå¹¶æ³¨å…¥CSS
if (options.autoInject) {
  manager.injectCSS()
}

// 5. å¯åŠ¨å“åº”å¼ç›‘å¬
if (options.enableResponsive) {
  startResponsiveWatcher()
}
```

### é”€æ¯æµç¨‹

```typescript
// 1. ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
manager.removeAllListeners()

// 2. æ¸…ç†CSSæ³¨å…¥
manager.removeCSS()

// 3. åœæ­¢å“åº”å¼ç›‘å¬
stopResponsiveWatcher()

// 4. æ¸…ç†å­˜å‚¨
if (options.clearOnDestroy) {
  storage.clear()
}

// 5. é‡Šæ”¾èµ„æº
manager.destroy()
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. å•ä¸€èŒè´£

æ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªç‰¹å®šçš„åŠŸèƒ½ï¼š

```typescript
// âœ… å¥½çš„åšæ³•
const fontManager = createFontSizeManager()
const spacingManager = createSpacingManager()

// âŒ é¿å…çš„åšæ³•
const everythingManager = createEverythingManager()
```

### 2. é…ç½®åˆ†ç¦»

å°†é…ç½®ä¸é€»è¾‘åˆ†ç¦»ï¼š

```typescript
// config.ts
// main.ts
import { sizeConfig } from './config'

export const sizeConfig = {
  defaultMode: 'medium',
  enableStorage: true
}
const manager = createSizeManager(sizeConfig)
```

### 3. ç±»å‹å®‰å…¨

å……åˆ†åˆ©ç”¨ TypeScript çš„ç±»å‹ç³»ç»Ÿï¼š

```typescript
// å®šä¹‰ä¸¥æ ¼çš„ç±»å‹
type StrictSizeMode = 'small' | 'medium' | 'large'

// ä½¿ç”¨ç±»å‹å®ˆå«
function isSizeMode(value: string): value is StrictSizeMode {
  return ['small', 'medium', 'large'].includes(value)
}
```

## ğŸ”— ç›¸å…³æ¦‚å¿µ

- [å°ºå¯¸æ¨¡å¼è¯¦è§£](./size-modes) - æ·±å…¥äº†è§£å°ºå¯¸æ¨¡å¼ç³»ç»Ÿ
- [å“åº”å¼è®¾è®¡](./responsive) - å“åº”å¼è®¾è®¡åŸç†
- [Vue é›†æˆ](./vue-plugin) - Vue æ¡†æ¶é›†æˆæ¦‚å¿µ
- [API è®¾è®¡](../api/core) - API è®¾è®¡åŸç†
