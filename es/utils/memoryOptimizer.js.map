{"version":3,"file":"memoryOptimizer.js","sources":["../../src/utils/memoryOptimizer.ts"],"sourcesContent":[null],"names":["WeakRefCache","constructor","cache","Map","globalThis","finalizationRegistry","FinalizationRegistry","key","delete","set","value","ref","WeakRef","register","get","undefined","deref","has","clear","size","cleanup","keysToDelete","entries","push","ObjectAssociatedCache","WeakMap","ExpiringCache","ttl","cleanupInterval","defaultTTL","startCleanup","expires","Date","now","entry","setInterval","cleanupTimer","unref","destroy","clearInterval","TieredCache","maxHotSize","hotCache","coldCache","accessCount","PROMOTION_THRESHOLD","incrementAccessCount","count","promoteToHot","hot","cold","demoteLeastAccessed","minKey","minCount","Infinity","keys","getStats","coldSize","Array","from","values","filter","length","totalAccessCount","reduce","sum","hotSize","memoryOptimizer","createWeakRefCache","createObjectCache","createExpiringCache","createTieredCache"],"mappings":";;;;;;;;;MAiCaA,YAAAA,CAAY;AAAA,EAIvBC,WAAAA,GAAA;AAHQ,IAAA,IAAA,CAAAC,KAAAA,uBAAYC,GAAAA,EAAG;AAKrB,IAAA,IAAI,OAAOC,UAAAA,KAAe,WAAA,IAAe,sBAAA,IAA0BA,UAAAA,EAAY;AAC7E,MAAA,IAAA,CAAKC,oBAAAA,GAAuB,IAAIC,oBAAAA,CAAsBC,CAAAA,GAAAA,KAAU;AAC9D,QAAA,IAAA,CAAKL,KAAAA,CAAMM,OAAOD,GAAG,CAAA;AAAA,MACvB,CAAC,CAAA;AAAA,IACH;AAAA,EACF;AAAA,EAEAE,GAAAA,CAAIF,KAAQG,KAAAA,EAAQ;AAClB,IAAA,MAAMC,GAAAA,GAAM,IAAIC,OAAAA,CAAQF,KAAK,CAAA;AAC7B,IAAA,IAAA,CAAKR,KAAAA,CAAMO,GAAAA,CAAIF,GAAAA,EAAKI,GAAG,CAAA;AAGvB,IAAA,IAAI,KAAKN,oBAAAA,EAAsB;AAC7B,MAAA,IAAA,CAAKA,oBAAAA,CAAqBQ,QAAAA,CAASH,KAAAA,EAAOH,GAAG,CAAA;AAAA,IAC/C;AAAA,EACF;AAAA,EAEAO,IAAIP,GAAAA,EAAM;AACR,IAAA,MAAMI,GAAAA,GAAM,IAAA,CAAKT,KAAAA,CAAMY,GAAAA,CAAIP,GAAG,CAAA;AAC9B,IAAA,IAAI,CAACI,KAAK,OAAOI,MAAAA;AAEjB,IAAA,MAAML,KAAAA,GAAQC,IAAIK,KAAAA;AAElB,IAAA,IAAI,CAACN,KAAAA,EAAO;AACV,MAAA,IAAA,CAAKR,KAAAA,CAAMM,OAAOD,GAAG,CAAA;AACrB,MAAA,OAAOQ,MAAAA;AAAAA,IACT;AAEA,IAAA,OAAOL,KAAAA;AAAAA,EACT;AAAA,EAEAO,IAAIV,GAAAA,EAAM;AACR,IAAA,OAAO,IAAA,CAAKO,GAAAA,CAAIP,GAAG,CAAA,KAAMQ,MAAAA;AAAAA,EAC3B;AAAA,EAEAP,OAAOD,GAAAA,EAAM;AACX,IAAA,OAAO,IAAA,CAAKL,KAAAA,CAAMM,MAAAA,CAAOD,GAAG,CAAA;AAAA,EAC9B;AAAA,EAEAW,KAAAA,GAAK;AACH,IAAA,IAAA,CAAKhB,MAAMgB,KAAAA;EACb;AAAA,EAEA,IAAIC,IAAAA,GAAI;AAEN,IAAA,IAAA,CAAKC,OAAAA,EAAO;AACZ,IAAA,OAAO,KAAKlB,KAAAA,CAAMiB,IAAAA;AAAAA,EACpB;AAAA,EAEQC,OAAAA,GAAO;AACb,IAAA,MAAMC,eAAoB,EAAA;AAE1B,IAAA,KAAA,MAAW,CAACd,GAAAA,EAAKI,GAAG,KAAK,IAAA,CAAKT,KAAAA,CAAMoB,SAAO,EAAI;AAC7C,MAAA,IAAI,CAACX,GAAAA,CAAIK,KAAAA,EAAK,EAAI;AAChBK,QAAAA,YAAAA,CAAaE,KAAKhB,GAAG,CAAA;AAAA,MACvB;AAAA,IACF;AAEA,IAAA,KAAA,MAAWA,OAAOc,YAAAA,EAAc;AAC9B,MAAA,IAAA,CAAKnB,KAAAA,CAAMM,OAAOD,GAAG,CAAA;AAAA,IACvB;AAAA,EACF;AACD;MAMYiB,qBAAAA,CAAqB;AAAA,EAAlCvB,WAAAA,GAAA;AACU,IAAA,IAAA,CAAAC,KAAAA,uBAAYuB,OAAAA,EAAO;AAAA,EAiB7B;AAAA,EAfEhB,GAAAA,CAAIF,KAAQG,KAAAA,EAAQ;AAClB,IAAA,IAAA,CAAKR,KAAAA,CAAMO,GAAAA,CAAIF,GAAAA,EAAKG,KAAK,CAAA;AAAA,EAC3B;AAAA,EAEAI,IAAIP,GAAAA,EAAM;AACR,IAAA,OAAO,IAAA,CAAKL,KAAAA,CAAMY,GAAAA,CAAIP,GAAG,CAAA;AAAA,EAC3B;AAAA,EAEAU,IAAIV,GAAAA,EAAM;AACR,IAAA,OAAO,IAAA,CAAKL,KAAAA,CAAMe,GAAAA,CAAIV,GAAG,CAAA;AAAA,EAC3B;AAAA,EAEAC,OAAOD,GAAAA,EAAM;AACX,IAAA,OAAO,IAAA,CAAKL,KAAAA,CAAMM,MAAAA,CAAOD,GAAG,CAAA;AAAA,EAC9B;AACD;MAMYmB,aAAAA,CAAa;AAAA,EAMxBzB,WAAAA,CAAY0B,GAAAA,GAAM,GAAA,EAAOC,eAAAA,GAAkB,GAAA,EAAK;AALxC,IAAA,IAAA,CAAA1B,KAAAA,uBAAYC,GAAAA,EAAG;AAMrB,IAAA,IAAA,CAAK0B,UAAAA,GAAaF,GAAAA;AAClB,IAAA,IAAA,CAAKC,eAAAA,GAAkBA,eAAAA;AACvB,IAAA,IAAA,CAAKE,YAAAA,EAAY;AAAA,EACnB;AAAA,EAEArB,GAAAA,CAAIF,GAAAA,EAAQG,KAAAA,EAAUiB,GAAAA,EAAY;AAChC,IAAA,MAAMI,OAAAA,GAAUC,IAAAA,CAAKC,GAAAA,EAAG,IAAMN,OAAO,IAAA,CAAKE,UAAAA,CAAAA;AAC1C,IAAA,MAAMlB,GAAAA,GAAM,IAAIC,OAAAA,CAAQF,KAAK,CAAA;AAC7B,IAAA,IAAA,CAAKR,KAAAA,CAAMO,IAAIF,GAAAA,EAAK;AAAA,MAAEI,GAAAA;AAAAA,MAAKoB;AAAAA,KAAS,CAAA;AAAA,EACtC;AAAA,EAEAjB,IAAIP,GAAAA,EAAM;AACR,IAAA,MAAM2B,KAAAA,GAAQ,IAAA,CAAKhC,KAAAA,CAAMY,GAAAA,CAAIP,GAAG,CAAA;AAChC,IAAA,IAAI,CAAC2B,OAAO,OAAOnB,MAAAA;AAGnB,IAAA,IAAIiB,IAAAA,CAAKC,GAAAA,EAAG,GAAKC,KAAAA,CAAMH,OAAAA,EAAS;AAC9B,MAAA,IAAA,CAAK7B,KAAAA,CAAMM,OAAOD,GAAG,CAAA;AACrB,MAAA,OAAOQ,MAAAA;AAAAA,IACT;AAGA,IAAA,MAAML,KAAAA,GAAQwB,KAAAA,CAAMvB,GAAAA,CAAIK,KAAAA;AACxB,IAAA,IAAI,CAACN,KAAAA,EAAO;AACV,MAAA,IAAA,CAAKR,KAAAA,CAAMM,OAAOD,GAAG,CAAA;AACrB,MAAA,OAAOQ,MAAAA;AAAAA,IACT;AAEA,IAAA,OAAOL,KAAAA;AAAAA,EACT;AAAA,EAEAO,IAAIV,GAAAA,EAAM;AACR,IAAA,OAAO,IAAA,CAAKO,GAAAA,CAAIP,GAAG,CAAA,KAAMQ,MAAAA;AAAAA,EAC3B;AAAA,EAEAP,OAAOD,GAAAA,EAAM;AACX,IAAA,OAAO,IAAA,CAAKL,KAAAA,CAAMM,MAAAA,CAAOD,GAAG,CAAA;AAAA,EAC9B;AAAA,EAEAW,KAAAA,GAAK;AACH,IAAA,IAAA,CAAKhB,MAAMgB,KAAAA;EACb;AAAA,EAEQY,YAAAA,GAAY;AAClB,IAAA,IAAI,OAAOK,gBAAgB,WAAA,EAAa;AAExC,IAAA,IAAA,CAAKC,YAAAA,GAAeD,YAAY,MAAK;AACnC,MAAA,IAAA,CAAKf,OAAAA,EAAO;AAAA,IACd,CAAA,EAAG,KAAKQ,eAAe,CAAA;AAGvB,IAAA,IAAI,IAAA,CAAKQ,aAAaC,KAAAA,EAAO;AAC3B,MAAA,IAAA,CAAKD,aAAaC,KAAAA;IACpB;AAAA,EACF;AAAA,EAEQjB,OAAAA,GAAO;AACb,IAAA,MAAMa,GAAAA,GAAMD,KAAKC,GAAAA;AACjB,IAAA,MAAMZ,eAAoB,EAAA;AAE1B,IAAA,KAAA,MAAW,CAACd,GAAAA,EAAK2B,KAAK,KAAK,IAAA,CAAKhC,KAAAA,CAAMoB,SAAO,EAAI;AAE/C,MAAA,IAAIW,GAAAA,GAAMC,MAAMH,OAAAA,EAAS;AACvBV,QAAAA,YAAAA,CAAaE,KAAKhB,GAAG,CAAA;AACrB,QAAA;AAAA,MACF;AAGA,MAAA,IAAI,CAAC2B,KAAAA,CAAMvB,GAAAA,CAAIK,KAAAA,EAAK,EAAI;AACtBK,QAAAA,YAAAA,CAAaE,KAAKhB,GAAG,CAAA;AAAA,MACvB;AAAA,IACF;AAEA,IAAA,KAAA,MAAWA,OAAOc,YAAAA,EAAc;AAC9B,MAAA,IAAA,CAAKnB,KAAAA,CAAMM,OAAOD,GAAG,CAAA;AAAA,IACvB;AAAA,EACF;AAAA,EAEA+B,OAAAA,GAAO;AACL,IAAA,IAAI,KAAKF,YAAAA,EAAc;AACrBG,MAAAA,aAAAA,CAAc,KAAKH,YAAY,CAAA;AAC/B,MAAA,IAAA,CAAKA,YAAAA,GAAerB,MAAAA;AAAAA,IACtB;AACA,IAAA,IAAA,CAAKb,MAAMgB,KAAAA;EACb;AACD;MAMYsB,WAAAA,CAAW;AAAA,EAOtBvC,WAAAA,CAAYwC,aAAa,GAAA,EAAG;AANpB,IAAA,IAAA,CAAAC,QAAAA,uBAAevC,GAAAA,EAAG;AAClB,IAAA,IAAA,CAAAwC,SAAAA,uBAAgBxC,GAAAA,EAAG;AAEnB,IAAA,IAAA,CAAAyC,WAAAA,uBAAkBzC,GAAAA,EAAG;AACZ,IAAA,IAAA,CAAA0C,mBAAAA,GAAsB,CAAA;AAGrC,IAAA,IAAA,CAAKJ,UAAAA,GAAaA,UAAAA;AAAAA,EACpB;AAAA,EAEAhC,GAAAA,CAAIF,KAAQG,KAAAA,EAAQ;AAElB,IAAA,IAAA,CAAKiC,UAAUlC,GAAAA,CAAIF,GAAAA,EAAK,IAAIK,OAAAA,CAAQF,KAAK,CAAC,CAAA;AAC1C,IAAA,IAAA,CAAKkC,WAAAA,CAAYnC,GAAAA,CAAIF,GAAAA,EAAK,CAAC,CAAA;AAAA,EAC7B;AAAA,EAEAO,IAAIP,GAAAA,EAAM;AAER,IAAA,IAAIG,KAAAA,GAAQ,IAAA,CAAKgC,QAAAA,CAAS5B,GAAAA,CAAIP,GAAG,CAAA;AACjC,IAAA,IAAIG,KAAAA,EAAO;AACT,MAAA,IAAA,CAAKoC,qBAAqBvC,GAAG,CAAA;AAC7B,MAAA,OAAOG,KAAAA;AAAAA,IACT;AAGA,IAAA,MAAMC,GAAAA,GAAM,IAAA,CAAKgC,SAAAA,CAAU7B,GAAAA,CAAIP,GAAG,CAAA;AAClC,IAAA,IAAII,GAAAA,EAAK;AACPD,MAAAA,KAAAA,GAAQC,IAAIK,KAAAA;AACZ,MAAA,IAAIN,KAAAA,EAAO;AACT,QAAA,IAAA,CAAKoC,qBAAqBvC,GAAG,CAAA;AAG7B,QAAA,MAAMwC,KAAAA,GAAQ,IAAA,CAAKH,WAAAA,CAAY9B,GAAAA,CAAIP,GAAG,CAAA,IAAK,CAAA;AAC3C,QAAA,IAAIwC,KAAAA,IAAS,KAAKF,mBAAAA,EAAqB;AACrC,UAAA,IAAA,CAAKG,YAAAA,CAAazC,KAAKG,KAAK,CAAA;AAAA,QAC9B;AAEA,QAAA,OAAOA,KAAAA;AAAAA,MACT,CAAA,MAAO;AAEL,QAAA,IAAA,CAAKiC,SAAAA,CAAUnC,OAAOD,GAAG,CAAA;AACzB,QAAA,IAAA,CAAKqC,WAAAA,CAAYpC,OAAOD,GAAG,CAAA;AAAA,MAC7B;AAAA,IACF;AAEA,IAAA,OAAOQ,MAAAA;AAAAA,EACT;AAAA,EAEAE,IAAIV,GAAAA,EAAM;AACR,IAAA,OAAO,IAAA,CAAKO,GAAAA,CAAIP,GAAG,CAAA,KAAMQ,MAAAA;AAAAA,EAC3B;AAAA,EAEAP,OAAOD,GAAAA,EAAM;AACX,IAAA,IAAA,CAAKqC,WAAAA,CAAYpC,OAAOD,GAAG,CAAA;AAC3B,IAAA,MAAM0C,GAAAA,GAAM,IAAA,CAAKP,QAAAA,CAASlC,MAAAA,CAAOD,GAAG,CAAA;AACpC,IAAA,MAAM2C,IAAAA,GAAO,IAAA,CAAKP,SAAAA,CAAUnC,MAAAA,CAAOD,GAAG,CAAA;AACtC,IAAA,OAAO0C,GAAAA,IAAOC,IAAAA;AAAAA,EAChB;AAAA,EAEAhC,KAAAA,GAAK;AACH,IAAA,IAAA,CAAKwB,SAASxB,KAAAA;AACd,IAAA,IAAA,CAAKyB,UAAUzB,KAAAA;AACf,IAAA,IAAA,CAAK0B,YAAY1B,KAAAA;EACnB;AAAA,EAEQ4B,qBAAqBvC,GAAAA,EAAM;AACjC,IAAA,MAAMwC,KAAAA,GAAQ,IAAA,CAAKH,WAAAA,CAAY9B,GAAAA,CAAIP,GAAG,CAAA,IAAK,CAAA;AAC3C,IAAA,IAAA,CAAKqC,WAAAA,CAAYnC,GAAAA,CAAIF,GAAAA,EAAKwC,KAAAA,GAAQ,CAAC,CAAA;AAAA,EACrC;AAAA,EAEQC,YAAAA,CAAazC,KAAQG,KAAAA,EAAQ;AAEnC,IAAA,IAAI,IAAA,CAAKgC,QAAAA,CAASvB,IAAAA,IAAQ,IAAA,CAAKsB,UAAAA,EAAY;AACzC,MAAA,IAAA,CAAKU,mBAAAA,EAAmB;AAAA,IAC1B;AAEA,IAAA,IAAA,CAAKR,SAAAA,CAAUnC,OAAOD,GAAG,CAAA;AACzB,IAAA,IAAA,CAAKmC,QAAAA,CAASjC,GAAAA,CAAIF,GAAAA,EAAKG,KAAK,CAAA;AAAA,EAC9B;AAAA,EAEQyC,mBAAAA,GAAmB;AACzB,IAAA,IAAIC,MAAAA;AACJ,IAAA,IAAIC,QAAAA,GAAWC,QAAAA;AAEf,IAAA,KAAA,MAAW/C,GAAAA,IAAO,IAAA,CAAKmC,QAAAA,CAASa,IAAAA,EAAI,EAAI;AACtC,MAAA,MAAMR,KAAAA,GAAQ,IAAA,CAAKH,WAAAA,CAAY9B,GAAAA,CAAIP,GAAG,CAAA,IAAK,CAAA;AAC3C,MAAA,IAAIwC,QAAQM,QAAAA,EAAU;AACpBA,QAAAA,QAAAA,GAAWN,KAAAA;AACXK,QAAAA,MAAAA,GAAS7C,GAAAA;AAAAA,MACX;AAAA,IACF;AAEA,IAAA,IAAI6C,WAAWrC,MAAAA,EAAW;AACxB,MAAA,MAAML,KAAAA,GAAQ,IAAA,CAAKgC,QAAAA,CAAS5B,GAAAA,CAAIsC,MAAM,CAAA;AACtC,MAAA,IAAI1C,KAAAA,EAAO;AACT,QAAA,IAAA,CAAKgC,QAAAA,CAASlC,OAAO4C,MAAM,CAAA;AAC3B,QAAA,IAAA,CAAKT,UAAUlC,GAAAA,CAAI2C,MAAAA,EAAQ,IAAIxC,OAAAA,CAAQF,KAAK,CAAC,CAAA;AAE7C,QAAA,IAAA,CAAKkC,WAAAA,CAAYnC,GAAAA,CAAI2C,MAAAA,EAAQ,CAAC,CAAA;AAAA,MAChC;AAAA,IACF;AAAA,EACF;AAAA,EAEAI,QAAAA,GAAQ;AAKN,IAAA,MAAMC,QAAAA,GAAWC,KAAAA,CAAMC,IAAAA,CAAK,IAAA,CAAKhB,SAAAA,CAAUiB,MAAAA,EAAQ,CAAA,CAChDC,MAAAA,CAAOlD,CAAAA,GAAAA,KAAOA,GAAAA,CAAIK,KAAAA,EAAO,CAAA,CACzB8C,MAAAA;AAEH,IAAA,MAAMC,gBAAAA,GAAmBL,KAAAA,CAAMC,IAAAA,CAAK,IAAA,CAAKf,YAAYgB,MAAAA,EAAQ,CAAA,CAC1DI,MAAAA,CAAO,CAACC,GAAAA,EAAKlB,KAAAA,KAAUkB,GAAAA,GAAMlB,OAAO,CAAC,CAAA;AAExC,IAAA,OAAO;AAAA,MACLmB,OAAAA,EAAS,KAAKxB,QAAAA,CAASvB,IAAAA;AAAAA,MACvBsC,QAAAA;AAAAA,MACAM;AAAAA;EAEJ;AACD;AAGM,MAAMI,eAAAA,GAAkB;AAAA,EAC7BC,kBAAAA,EAAoBA,MAA2B,IAAIpE,YAAAA,EAAY;AAAA,EAC/DqE,iBAAAA,EAAmBA,MAA2B,IAAI7C,qBAAAA,EAAqB;AAAA,EACvE8C,mBAAAA,EAA2C3C,CAAAA,GAAAA,KAAiB,IAAID,aAAAA,CAAoBC,GAAG,CAAA;AAAA,EACvF4C,iBAAAA,EAAyC9B,CAAAA,UAAAA,KAAwB,IAAID,WAAAA,CAAkBC,UAAU;;;;;;;;"}